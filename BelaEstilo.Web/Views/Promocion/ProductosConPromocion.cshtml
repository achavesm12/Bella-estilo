@model IEnumerable<BelaEstilo.Application.DTOs.ProductoDTO>

@{
    ViewData["Title"] = "Productos con Promoción";
    var promociones = ViewBag.Promociones as Dictionary<int, decimal>;
}

<h2 class="text-center py-3">Productos con Promoción</h2>

<div class="container">
    <div class="row">
        @foreach (var producto in Model)
        {
            var tienePromo = promociones != null && promociones.ContainsKey(producto.IdProducto);
            var precioConDescuento = tienePromo ? promociones[producto.IdProducto] : 0;

            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    @* Si tienes imagenes, puedes agregarlas aquí *@
                    @*
                @if (producto.ImagenProducto.Any())
                {
                <img src="@producto.ImagenProducto.First().UrlImagen" class="card-img-top" alt="@producto.Nombre" />
                }
                *@

                    <div class="card-body">
                        <h5 class="card-title">@producto.Nombre</h5>

                        <p>
                            <span class="badge bg-primary me-2">
                                <i class="bi bi-tags"></i> @producto.IdCategoriaNavigation?.Nombre
                            </span>
                        </p>

                        @if (tienePromo && producto.Precio.HasValue)
                        {
                            <p>
                                <span style="color: red; text-decoration: line-through;">
                                    ₡@producto.Precio.Value.ToString("N2")
                                </span><br />
                                <span style="color: green; font-weight: bold;">
                                    ₡@precioConDescuento.ToString("N2")
                                </span>
                            </p>
                        }
                        else if (producto.Precio.HasValue)
                        {
                            <p>
                                <span>₡@producto.Precio.Value.ToString("N2")</span>
                            </p>
                        }
                        else
                        {
                            <p>Precio no disponible</p>
                        }

                        <p>@producto.Descripcion</p>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
